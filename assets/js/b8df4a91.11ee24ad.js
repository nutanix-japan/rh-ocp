"use strict";(self.webpackChunkrh_ocp=self.webpackChunkrh_ocp||[]).push([[4724],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),u=p(n),d=r,h=u["".concat(s,".").concat(d)]||u[d]||m[d]||o;return n?a.createElement(h,l(l({ref:t},c),{},{components:n})):a.createElement(h,l({ref:t},c))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=d;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[u]="string"==typeof e?e:r,l[1]=i;for(var p=2;p<o;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},1028:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>g,frontMatter:()=>o,metadata:()=>i,toc:()=>p});var a=n(7462),r=(n(7294),n(3905));const o={title:"Deploy"},l=void 0,i={unversionedId:"ocp_ipi_install/ocp_ipi_install_cleanup",id:"ocp_ipi_install/ocp_ipi_install_cleanup",title:"Deploy",description:"Deploying OCP Cluster",source:"@site/docs/ocp_ipi_install/ocp_ipi_install_cleanup.mdx",sourceDirName:"ocp_ipi_install",slug:"/ocp_ipi_install/ocp_ipi_install_cleanup",permalink:"/rh-ocp/ocp_ipi_install/ocp_ipi_install_cleanup",draft:!1,editUrl:"https://github.com/nutanix-japan/rh-ocp/edit/main/docs/ocp_ipi_install/ocp_ipi_install_cleanup.mdx",tags:[],version:"current",lastUpdatedBy:"Nutanix Japan",lastUpdatedAt:1684818370,formattedLastUpdatedAt:"May 23, 2023",frontMatter:{title:"Deploy"},sidebar:"tutorialSidebar",previous:{title:"Create Configuration Manifests",permalink:"/rh-ocp/ocp_ipi_install/ocp_ipi_config_file"},next:{title:"OCP and Nutanix NDB",permalink:"/rh-ocp/ocp_ndb/"}},s={},p=[{value:"Deploying OCP Cluster",id:"deploying-ocp-cluster",level:2},{value:"Cleanup (optional)",id:"cleanup-optional",level:2}],c=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",t)},u=c("BrowserWindow"),m=c("Tabs"),d=c("TabItem"),h={toc:p};function g(e){let{components:t,...o}=e;return(0,r.kt)("wrapper",(0,a.Z)({},h,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"deploying-ocp-cluster"},"Deploying OCP Cluster"),(0,r.kt)("p",null,"This will be simplest part of all, provided you have done everything correctly to this point. "),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Start the installation of OCP cluster by executing the following"),(0,r.kt)(u,{mdxType:"BrowserWindow"},(0,r.kt)("details",null,(0,r.kt)("summary",null,"Do you need more details about installation?"),(0,r.kt)("div",null,(0,r.kt)("body",null,(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"nohup openshift-install create cluster --log-level=debug &\n")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Now you can follow the nohup logs to see installation progress"',title:'"Now',you:!0,can:!0,follow:!0,the:!0,nohup:!0,logs:!0,to:!0,see:!0,installation:!0,'progress"':!0},"tail -f nohup.out\n")))))),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"nohup openshift-install create cluster &\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"A typical installation flow would look like this"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-buttonless",metastring:'{16,18} title="Install output - note the access information to the OCP cluster"',"{16,18}":!0,title:'"Install',output:!0,"-":!0,note:!0,the:!0,access:!0,information:!0,to:!0,OCP:!0,'cluster"':!0},'openshift-install create cluster\n#\nINFO Consuming Master Machines from target directory \nINFO Consuming OpenShift Install (Manifests) from target directory \nINFO Consuming Common Manifests from target directory \nINFO Consuming Openshift Manifests from target directory \nINFO Consuming Worker Machines from target directory \nINFO Creating infrastructure resources...         \nINFO Waiting up to 20m0s (until 8:16AM) for the Kubernetes API at https://api.xyz.ntnxlab.local:6443... \nINFO API v1.24.0+b62823b up                       \nINFO Waiting up to 30m0s (until 8:27AM) for bootstrapping to complete... \nINFO Destroying the bootstrap resources...        \nINFO Waiting up to 40m0s (until 8:49AM) for the cluster at https://api.xyz.ntnxlab.local:6443 to initialize... \nINFO Waiting up to 10m0s (until 8:30AM) for the openshift-console route to be created... \nINFO Install complete!                            \nINFO To access the cluster as the system:admin user when using \'oc\', run \nINFO     export KUBECONFIG=/root/xyz/auth/kubeconfig \nINFO Access the OpenShift web-console here: https://console-openshift-console.apps.xyz.ntnxlab.local \nINFO Login to the console with user: "kubeadmin", and password: "xxxx-xxxx-xxxx-xxxx" \nINFO Time elapsed: 27m0s\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Once the installation is done we can access OCP cluster using the following ways:"),(0,r.kt)(m,{groupId:"Login Method",mdxType:"Tabs"},(0,r.kt)(d,{value:"kubeconfig file",label:"kubeconfig",mdxType:"TabItem"},(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-text",metastring:'title="Export your kubeconfig file to env"',title:'"Export',your:!0,kubeconfig:!0,file:!0,to:!0,'env"':!0},"export KUBECONFIG=/root/xyz/auth/kubeconfig\n"))),(0,r.kt)(d,{value:"kubeadmin credentials",label:"kubeadmin",mdxType:"TabItem"},(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-text",metastring:'title="Make sure to use your password"',title:'"Make',sure:!0,to:!0,use:!0,your:!0,'password"':!0},"oc login -u kubeadmin -p xxxxx-xxxxx-xxxxx-xxxxx\n")))),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"oc get nodes\n##\nNAME                     STATUS   ROLES    AGE     VERSION\nxyz-6zlwh-master-0       Ready    master   14m   v1.24.0+b62823b\nxyz-6zlwh-master-1       Ready    master   14m   v1.24.0+b62823b\nxyz-6zlwh-master-2       Ready    master   14m   v1.24.0+b62823b\nxyz-6zlwh-worker-czbn7   Ready    worker   14m   v1.24.0+b62823b\nxyz-6zlwh-worker-njv66   Ready    worker   14m   v1.24.0+b62823b\nxyz-6zlwh-worker-mlgbh   Ready    worker   14m   v1.24.0+b62823b\n")),(0,r.kt)("p",{parentName:"li"},"Through the OCP GUI using kubeadmin credentials"),(0,r.kt)("p",{parentName:"li"},"From your UserXX-WindowsToolsPC, open Chrome"),(0,r.kt)("p",{parentName:"li"},"Open the following URL"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-url"},"https://console-openshift-console.apps.xyz.ntnxlab.local\n")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{src:n(579).Z,width:"1407",height:"626"})),(0,r.kt)("p",{parentName:"li"},"You have sucessfully installed OCP using IPI."))),(0,r.kt)("h2",{id:"cleanup-optional"},"Cleanup (optional)"),(0,r.kt)("p",null,"Run through the following if you would like to delete the OCP cluster. This step is optional for HPOC as it resets at the  end of reservation."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"In your UserXX-LinuxToolsVM ")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Change to you working directory that we created before (if not there already)"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"cd /root/xyz\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Clean up with the following command:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"openshift-install destroy cluster \n")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-buttonless",metastring:'title="Output"',title:'"Output"'},'INFO Starting deletion of Nutanix infrastructure for Openshift cluster "xyz-6zlwh" \nINFO Virtual machines scheduled to be deleted:    \nINFO - xyz-6zlwh-master-2                         \nINFO - xyz-6zlwh-master-1                         \nINFO - xyz-6zlwh-master-0                         \nINFO - xyz-6zlwh-worker-qzslg                     \nINFO - xyz-6zlwh-worker-xjfk9    \nINFO - xyz-6zlwh-worker-mlgbh                 \nINFO Deleting VM xyz-6zlwh-master-2 with ID d7d5f8ac-6190-4708-93d7-c065f24f658c \nINFO Deleting VM xyz-6zlwh-master-1 with ID 050dca81-be33-4b9f-9868-44853810ea99 \nINFO Deleting VM xyz-6zlwh-master-0 with ID 13adfbae-3b22-443e-88e9-e8e58d2be78e \nINFO Deleting VM xyz-6zlwh-worker-qzslg with ID 93a3efc8-cdc6-4df9-a5d5-0ba420e033ab \nINFO Deleting VM xyz-6zlwh-worker-xjfk9 with ID 056f313e-b426-4ec3-a740-2c2ccd8e83ef\nINFO Deleting VM xyz-6zlwh-worker-mlgbh with ID 056f313e-b426-4ef6-a740-2c2ccd8e83vc \nINFO Deleting image "xyz-6zlwh-rhcos" with UUID "3001064e-46ce-4f62-b8d3-116a24eedf55" \nINFO Deleting category value : shared             \nINFO Deleting category value : owned              \nINFO Deleting category key : kubernetes-io-cluster-xyz-6zlwh \nINFO Time elapsed: 32s   \n')))),(0,r.kt)("p",null,"IPI installation method is simple and consistent to deploy as after the pre-rquisites are setup once. "),(0,r.kt)("p",null,"Customers can easily deploy as many OCP clusters on Nutanix HCI."))}g.isMDXComponent=!0},579:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/ipi-installed-cluster-f77dfcb37251b37decfd9f06360571a0.png"}}]);